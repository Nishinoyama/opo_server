<header>
  <h1>
    OpoServerWeb
  </h1>
</header>

<section>
  <h2>
    <%= @tournament.name %>
    <%= link_to "[edit]", edit_tournament_path(@tournament) %>
    <%= button_to "[delete]", tournament_path(@tournament),
                method: :delete,
                data: { confirm: "OK?"} %>
  </h2>
  <h3>
    Participants
  </h3>
  <ul>
    <% @tournament.players_sorted.each do |ps| %>
      <% p = ps[:player] %>
      <% s = ps[:score] %>
      <% r = ps[:results] %>
      <li>
        <div style="float: left; width: 240px; overflow: hidden; display: inline-flex;">
          <%= p.name %>
          <%= link_to "[show]", p %>
        </div>
        <div style="float: left; width: 60px;" >
          Pts:
          <%= s[:points] %>
        </div>
        <div style="float: left; width: 120px;" >
          OMWP:
          <%= s[:omwp].round 3 %>
        </div>
        <div style="float: left; width: 120px;" >
          GWP:
          <%= s[:gwp].round 3 %>
        </div>
        <div style="float: left; width: 120px;" >
          OMWP:
          <%= s[:ogwp].round 3 %>
        </div>
        <% r.each do |m| %>
          <div style="display: inline-block; width: 144px; background-color: <%= m.result_color %>; ">
            <% if m.finished? %>
              <div style="display: inline; float: left; width: 48px; padding-right: 12px; white-space: nowrap">
                <%= m.result_symbol %>
                <%= m.opponent_id %>
              </div>
              <div style="display: inline; margin-right: auto;">
                <%= m.win_count %>
                -
                <%= m.draw_count %>
                -
                <%= m.lose_count %>
              </div>
            <% else %>
              <div style="display: inline; margin-right: auto;">
                <%= m.matching_status %>
              </div>
            <% end %>
          </div>
        <% end %>
      </li>
    <% end %>
  </ul>
</section>
